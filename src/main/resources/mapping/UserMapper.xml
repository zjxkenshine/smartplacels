<?xml version = "1.0" encoding = "UTF-8"?>
<!DOCTYPE mapper PUBLIC
        "-//mybatis.org//DTD com.example.Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.csdl.smartplacenew.mapper.UserMapper">
    <resultMap id="result" type="com.csdl.smartplacenew.pojo.User">
        <result property="id" column="id"/>
        <result property="code" column="code" />
        <result property="username" column="username" />
        <result property="loginname" column="loginname" />
        <result property="password" column="password" />
        <result property="jointime" column="jointime" />
        <result property="level" column="level" />
        <result property="status" column="status" />
        <result property="delstatus" column="delstatus" />
        <result property="county" column="county" />
    </resultMap>


    <insert id="addUser">

        insert into user (code,username,loginname,password,jointime,level,status,delstatus,county) values (
        #{code},#{username},#{loginname},#{password},#{jointime},#{level},#{status},#{delstatus},#{county})

   </insert>

    <select id="getUserById" resultMap="result">

        select *  from user where id=#{id}

    </select>

    <update id="updateUserStatus">

        update user set status=0 where  id=#{id}

    </update>


    <update id="updateUserStatus2">

        update user set status=1 where  id=#{id}

    </update>



    <update id="updateUserDelStatus">

        update user set delstatus=0 where  id=#{id}

    </update>



    <update id="updateUserById" >

        update user set
        code =#{code},
        username=#{username},
        loginname=#{loginname},
        password=#{password},
        level=#{level},
        county=#{county}

         where id=#{id}

    </update>


    <select id="getUsrByKey"  resultMap="result">


        select *  from user

        where
        delstatus=1

        <if test="key!=null">
            and username like #{key}
        </if>


    </select>



    <select id="getUsrByKeyOfAdmin" resultMap="result">

        select *  from user

        where
        delstatus=1 and level=2

        <if test="key!=null">
            and username like #{key}
        </if>

    </select>



    <select id="getUsrByKeyOfUser" resultMap="result">

        select *  from user

        where
        delstatus=1 and level=1

        <if test="key!=null">
            and username like #{key}
        </if>

    </select>





    <select id="getUserByLoginName" resultMap="result">

        select *  from user where
        loginname =#{loginname}
        and delstatus=1
      order by id desc
    </select>




    <select id="getUserByLoginAndPassword" resultMap="result">

        select *  from user where
        loginname =#{loginname}
        and password=#{password}
        and status=1
        and delstatus=1

    </select>



    <select id="getUsrByKeyCount" resultType="integer">


        select count(*)  from user

        where
        delstatus=1

        <if test="key!=null">
            and username like #{key}
        </if>


    </select>
    
    
    
    
    <select id="getUsrByKeyCountOfAdmin" resultType="integer">

        select count(*)  from user

        where
        delstatus=1 and level=2

        <if test="key!=null">
            and username like #{key}
        </if>


    </select>




    <select id="getUsrByKeyCountOfUser" resultType="integer">

        select count(*)  from user

        where
        delstatus=1 and level=1

        <if test="key!=null">
            and username like #{key}
        </if>


    </select>

</mapper>