<?xml version = "1.0" encoding = "UTF-8"?>
<!DOCTYPE mapper PUBLIC
        "-//mybatis.org//DTD com.example.Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.csdl.smartplacenew.mapper.RoadnumberMapper">
    <resultMap id="result" type="com.csdl.smartplacenew.pojo.Roadnumber">
        <result property="id" column="id"/>
        <result property="roadnum" column="roadnum" />
        <result property="name" column="name" />
        <result property="lonandlat" column="lonandlat" />
        <result property="type" column="type" />
        <result property="url" column="url" />
        <result property="voiceurl" column="voiceurl" />
        <result property="status" column="status" />

        <result property="textofmater" column="textofmater" />
        <result property="size" column="size" />
        <result property="yearofesent" column="yearofesent" />
        <result property="mainteunit" column="mainteunit" />
        <result property="numofmaint" column="numofmaint" />
        <result property="maintperiod" column="maintperiod" />
        <result property="maintcost" column="maintcost" />
        <result property="maintaccounts" column="maintaccounts" />

        <result property="mandarinword" column="mandarinword" />
        <result property="englishword" column="englishword" />
        <result property="userid" column="userid" />
        <result property="sharelinks" column="sharelinks" />

    </resultMap>


    <insert id="addRoadnumber">

        insert into roadnumber (roadnum,name,lonandlat,type,url,voiceurl,status,

          textofmater,size,yearofesent,mainteunit,numofmaint,maintperiod,maintcost,maintaccounts,
          userid,sharelinks,englishword

        ) values (#{roadnum},
        #{name},#{lonandlat},#{type},#{url},#{voiceurl},1,
          #{textofmater},#{size}, #{yearofesent}, #{mainteunit}, #{numofmaint},#{maintperiod},#{maintcost},#{maintaccounts},
          #{userid},#{sharelinks},#{englishword}

        );

   </insert>

    <select id="getRoadnumberById" resultMap="result">

        select *  from roadnumber where id=#{id} and userid=#{userid} and status=1

    </select>

    <update id="updateRoadnumberStatus">

        update roadnumber set status=0 where  id=#{id} and userid=#{userid}

    </update>


    <update id="updateRoadnumberById" >

        update roadnumber set
        roadnum=#{roadnum},
         name =#{name},
         lonandlat=#{lonandlat},
         type=#{type},
         url=#{url},
         voiceurl=#{voiceurl},

         textofmater=#{textofmater},
         size=#{size},
         yearofesent=#{yearofesent},
         mainteunit=#{mainteunit},
         numofmaint=#{numofmaint},
         maintperiod=#{maintperiod},
         maintcost=#{maintcost},
         maintaccounts=#{maintaccounts},
         sharelinks=#{sharelinks},
         englishword=#{englishword}

          where id=#{id} and userid=#{userid}

    </update>


    <select id="getRoadnumberByKey"  resultMap="result">

        select *  from roadnumber

        where
        status=1

        and
        userid=#{userid}

        <if test="key!=null">
           and name like #{key} and status=1 or type like #{key} and status=1
        </if>
        order by name asc

    </select>



    <select id="getRoadnumberByKeyCount"  resultType="integer">

        select count(*)  from roadnumber

        where
        status=1
        and

        userid=#{userid}

        <if test="key!=null">
            and name like #{key} and status=1 or type like #{key} and status=1
        </if>


    </select>


    <insert id="addMaintrecordsOfRoadNum">

        insert into maintrecords (mainttype, number, maintcontent, maintcompany, contacts, contactsnum, cost, mainttime,userid)
        values (#{mainttype},#{number},#{maintcontent},#{maintcompany},#{contacts},#{contactsnum},#{cost},#{mainttime},#{userid})

    </insert>


    <select id="getRoadNumIdByName" resultType="integer">

        select id from roadnumber where lonandlat =#{lonandlat} and status=1 and userid=#{userid}

    </select>


    <select id="getRoadNumIdByName2" resultType="integer">

        select id from roadnumber where name =#{name} and status=1

    </select>


    <select id="getLonAndLat" resultType="string">

        select  lonandlat from roadnumber where status=1 and userid=#{userid}


    </select>


    <select id="getRoadNumberByLonAndLat"  resultMap="result">

        select *  from roadnumber where lonandlat=#{lonandlat} and  status=1 and userid=#{userid}

    </select>


    <select id="getRoadNumberByUrl"  resultMap="result">

        select *  from roadnumber where url=#{url} and  status=1  and userid=#{userid}

    </select>



    <insert id="addCountOfRoadNumber">

        insert into count ( name, count2, monthlyvisits,type,status,yearlyvisits,userid)values
        (#{name},#{count2},#{monthlyvisits},#{type},#{status},#{yearlyvisits},#{userid});

    </insert>


    <select id="getRoadNumByName"  resultMap="result">

        select *  from roadnumber where name=#{name} and  status=1 and userid=#{userid}

    </select>


    <update id="updateMandarinword">

        update roadnumber
        set mandarinword=#{word}
           where id= #{id}
         and status=1

         and userid=#{userid}


    </update>



    <update id="updateEnglishword">

        update roadnumber
        set englishword=#{word}
          where id= #{id}
         and status=1

  and userid=#{userid}

    </update>

    <select id="getUrlById" resultType="string">

        select url from roadnumber where id=#{id}  and userid=#{userid}

    </select>


    <select id="getIdByUrl" resultType="integer">

        select id from  roadnumber where url=#{url} and status=1  and userid=#{userid}

    </select>


    <select id="getMaxId" resultType="integer">

        select max(id) from roadnumber where status=1  and userid=#{userid}

    </select>


    <select id="getMinId" resultType="integer">

        select min(id) from roadnumber where status=1  and userid=#{userid}

    </select>

    <update id="addLonAndLatByUrl">

        update roadnumber set lonandlat=#{LonAndLat} where url=#{url}  and userid=#{userid}

    </update>


    <select id="getMaxIdByAll" resultType="integer">

        select max(id) from roadnumber where status=1   and userid=#{userid}

    </select>



    <select id="getRoadnumberByMaxId" resultMap="result">

       select *  from roadnumber where status=1 and

        id=(select max(id)  from roadnumber where status=1 and userid=#{userid})

        and userid=#{userid}

    </select>



    <select id="getNameAndUrl" resultMap="result">

        select name ,url from roadnumber where status=1 and userid=#{userid} and  status=1

    </select>


    <select id="getNameByUrlAndUserId" resultType="string">

        select name from roadnumber where url=#{url} and userid=#{userid} and  status=1

    </select>


    <select id="getRoadnumberByNameAndUserId" resultMap="result">

        select *  from roadnumber where name like #{name} and    userid=#{userid} and  status=1 order by name asc

    </select>


    <select id="getUrlByNameAndUserId" resultType="string">

        select url from roadnumber where name=#{name} and  userid=#{userid}  and status=1

    </select>






    <select id="getOrderIndexRoadNumberByUserid" resultType="integer">

        select  orderindex from roadnumber where    url =#{url} and status=1 and userid=#{userid}

    </select>


    <select id="getMaxOrderIndexRoadNumberByUserId" resultType="integer">

          select max(orderindex) from roadnumber where  status=1 and userid=#{userid}

    </select>


    <select id="getMinOrderIndexRoadNumberByUserId" resultType="integer">

           select min(orderindex) from roadnumber where  status=1 and userid=#{userid}

    </select>


    <select id="getUrlByOrderIndexRoadNumberByUserId" resultType="string">

           select url from roadnumber where orderindex=#{orderindex} and userid=#{userid} and status=1

    </select>
</mapper>